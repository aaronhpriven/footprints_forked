{% extends 'base.html' %}
{% load compress %}

{% block title %}Detail{% endblock %}

{% block css %}
    <link href="{{STATIC_URL}}jquery-ui-1.11.2/jquery-ui.css" rel="stylesheet" />
    <link href="{{STATIC_URL}}bootstrap3-editable/css/bootstrap-editable.css" rel="stylesheet" />
{% endblock %}

{% block extrahead %}
    <link href="{{STATIC_URL}}select2-3.5.2/select2.css" rel="stylesheet" />
    
    {% include "xeditable/actor.html" %}
    {% include "xeditable/author.html" %}
    {% include "xeditable/digitalobject.html" %}
    {% include "xeditable/place.html" %}
    {% include "xeditable/publisher.html" %}
    {% include "xeditable/title.html" %}
    {% include "xeditable/identifier.html" %}
    {% include "clientside/footprint.html" %}
    {% include "clientside/footprint_book.html" %}
    {% include "clientside/footprint_carousel.html" %}
    {% include "clientside/footprint_connect.html" %}
    {% include "clientside/footprint_progress.html" %}
{% endblock %}

{% block js %}
    <script type="text/javascript" src="//maps.google.com/maps/api/js?libraries=places&sensor=false"></script>
    <script src="{{STATIC_URL}}js/underscore-min.js"></script>
    <script src="{{STATIC_URL}}js/backbone-min.js"></script>
    <script src="{{STATIC_URL}}js/plupload/plupload.full.min.js"></script>
    <script src="{{STATIC_URL}}tinymce/tinymce.min.js"></script>

    {% compress js %}
        <script src="{{STATIC_URL}}select2-3.5.2/select2.js"></script>
        <script src="{{STATIC_URL}}jquery-ui-1.11.2/jquery-ui.js"></script>
        <script src="{{STATIC_URL}}bootstrap3-editable/js/bootstrap-editable.js"></script>
        <script src="{{STATIC_URL}}js/xeditable/bootstrap-editable-actor.js"></script>
        <script src="{{STATIC_URL}}js/xeditable/bootstrap-editable-digitalobject.js"></script>
        <script src="{{STATIC_URL}}js/xeditable/bootstrap-editable-identifier.js"></script>
        <script src="{{STATIC_URL}}js/xeditable/bootstrap-editable-place.js"></script>
        <script src="{{STATIC_URL}}js/xeditable/bootstrap-editable-title.js"></script>
        <script src="{{STATIC_URL}}js/app/footprint-detail.js"></script>
    {% endcompress %}

    <script type="text/javascript">
        jQuery(document).ready(function() {
            var editView = new FootprintView({
                el: jQuery('div.object-detail'),
                footprint: {'id': '{{footprint.id}}'},
                book_copy: {'id': '{{footprint.book_copy.id}}'},
                bookTemplate: jQuery('#book-detail-template'),
                detailTemplate: jQuery('#footprint-detail-template'),
                connectTemplate: jQuery('#connect-record-template'),
                carouselTemplate: jQuery('#carousel-template'), 
                progressTemplate: jQuery('#progress-sidebar-template'),
                baseContext: {
                    all_languages: [{% for language in languages %}
                                    {value: '{{language.id}}', text: "{{language.name}}"}{% if not forloop.last %},{% endif %}
                                    {% endfor %}],
                    all_mediums:  [{% for medium in footprint.MEDIUM_CHOICES %}
                                   {value: '{{medium}}', text: "{{medium}}"}{% if not forloop.last %},{% endif %}
                                   {% endfor %}],
                    editable: {% if editable %}true{% else %}false{% endif %},
                    csrf_token: '{{csrf_token}}',
                    static_url: '{{STATIC_URL}}'
                }
            });
        });
    </script>
{% endblock %}

{% block content %}
    <div class="object-detail">
        {% csrf_token %}
        <div class="row">
            <div class="col-md-8">
                <div class="footprint-detail"></div>
                <div class="book-detail"></div>
            </div>
            <div class="col-md-4">
                <div class="progress-detail"></div>
                <div class="connect-record"></div>
            </div>
        </div>
    
        <div class="modal" id="confirm-modal" tabindex="-1" role="dialog" aria-labelledby="Confirm" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title">Confirm</h4>
                    </div>
                    <div class="modal-body"></div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default btn-cancel" data-dismiss="modal">No</button>
                        <button type="button" class="btn btn-primary btn-confirm" data-dismiss="modal">Yes</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal" id="carousel-modal" tabindex="-1" role="dialog" aria-labelledby="Carousel" aria-hidden="true">
            <div class="modal-dialog  modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    </div>
                    <div class="modal-body"></div>
                </div>
            </div>
        </div>

        <div class="modal" id="connect-book-modal" taxindex="-1" role="dialog" aria-labelledby="Book Copy" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title">Connect Book Copy</h4>
                    </div>
                    <div class="modal-body">
                        <p>Connect to an existing book copy or create a new copy</p>
                        <form action="/connect/footprint/{{footprint.id}}/" method="post">
                            <input type="hidden" name="csrfmiddlewaretoken" value="<%=csrf_token%>" />
                            <div class="form-group writtenwork">
                                <label>Book</label>
                                <input value="{{footprint.book_copy.imprint.work.id}}" type="hidden" name="work" class="select-object work" data-url="/api/writtenwork/" placeholder="Select a book" />
                            </div>
                            <div class="form-group imprint">
                                <label>Imprint</label>
                                <input value="{{footprint.book_copy.imprint.id}}" type="hidden" name="imprint" class="select-object imprint"  data-url="/api/imprint/" placeholder="New Imprint"  />
                            </div>
                            <div class="form-group">
                                <label>Physical Copy</label>
                                <input value="{{footprint.book_copy.id}}" type="hidden" name="book" class="select-object book"  data-url="/api/book/" placeholder="New Book Copy"  />
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default btn-cancel" data-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary btn-confirm" data-dismiss="modal">Save</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
